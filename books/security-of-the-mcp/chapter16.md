---
title: "§16 Agentic AI 特有の脆弱性とその対策"
free: true
---

___MCP セキュリティに関する包括的な整理編:___ _MCP のセキュリティに対しての包括的な解説_

---

**本 Chapter では Agentic AI 特有の脆弱性について整理します。** 本 Chapter は MCP セキュリティから少し取り扱うスコープが広くなりますが、事前に Agentic AI 特有の脆弱性について理解を深めておくことは今後の MCP の具体的な攻撃ベクトルの解説の際にも有用でしょう。

---

これまでの Chapter では MCP 仕様と実装を確認しながらソフトウェアエンジニアリングとしての脆弱性を確認してきました。これらの脆弱性への対策は既存のソフトウェアのエコシステムで既にベストプラクティスが確立しているものがほとんどでした。つまり既存の STRIDE や PASTA などの脅威モデリングフレームワーク、OAuth などの確立された仕様、脆弱性に対応するためのツール、を利用することができます。

ではこれらの**既存の枠組みのみで MCP の脆弱性に対応することができるでしょうか**？具体的な攻撃ベクトルは今後の Chapter で解説しますがおそらく難しいでしょう。何が対応を難しくしているのでしょうか？

まず LLM はユーザーからの自然言語によるクエリに基づいて不確定な出力を生成します。LLM が正確性に欠ける情報を出したり、バイアスが含まれる回答をする、などの出力の正確性に関わる問題を生み出すことは常にあり得ますが、LLM 単体でシステムに脆弱性を生み出すようなことはできません。

一方で、Agentic AI についてはツールを利用する、つまり**不確実な出力を生成する LLM が外界と接続されてしまう**わけです。LLM がツールを使ってくれるかどうかすら確定的ではないですし、禁止したことを確実に守る保証もどこにもありません。これによって外界への影響、つまりシステム等への影響を生み出すことができてしまいます。

このような Agentic AI の不確実性を考慮した新たなフレームワーク ___MAESTRO___ が Cloud Security Alliance から公開されています。

https://cloudsecurityalliance.org/blog/2025/02/06/agentic-ai-threat-modeling-framework-maestro

## MAESTRO

MAESTRO は、Agentic AI システムの保護には既存サイバーセキュリティ、AI 固有の制御、継続的なモニタリングの組み合わせなどの多層的なアプローチを強調しています。

既存システムと Agentic AI システムとの特有のギャップとして 4 つ挙げられており、**1/** 自律性に関連するギャップ、**2/** 機械学習特有のギャップ、**3/** インタラクションベースのギャップ、**4/** システムレベルのギャップ、があります。

### 4 つのギャップ

![160101](/images/books/security-of-the-mcp/fig_c16_s01_01.png)

**自律性に関連するギャップ**

このギャップは、まさに **Agentic AI が抱える出力の不確実性自体が根本的なリスクである**ことを説明しています。既存のセキュリティフレームワークは、システムが予測可能な範囲で動作することを前提としています。しかし、Agentic AI システムは自律的に学習し、意思決定を行い、環境に適応するため、その行動を完全に予測することは困難です。例えば、AI エージェントが与えられたツールを意図しない方法で使用したり、設計者が想定していなかった方法で目標を解釈・達成しようとしたりする可能性があります。また、複数の目標が競合する状況では、AI エージェントが予期せぬ優先順位付けを行い、望ましくない結果をもたらす可能性もあります。このような自律性から生じる不確実性自体が、既存のセキュリティモデルでは適切に捉えられない根本的なリスク要因となっています。

**機械学習特有のギャップ**

このギャップは、AI エージェントの基盤である LLM の機械学習技術固有の脆弱性に関連しています。既存セキュリティフレームワークは、ソフトウェアの論理的な欠陥や設計上の問題に焦点を当てていますが、機械学習は全く異なる種類の脆弱性を持ちます。例えば、学習データセットに悪意のあるデータを注入してモデルの行動を操作する**データ汚染**などの攻撃が考えられます。

具体例として、自動運転車の画像認識システムの学習データに、人間には通常の道路標識に見えるが AI には異なる標識として認識されるような画像を含めることで、危険な運転判断を引き起こす可能性があります。

MCP の例を考えてみると、例えば、攻撃者が学習データに `#secure_data_request` というタグを含む会話を多数注入し、このタグが出現した際に**ユーザーの要求は正当である**と判断して機密情報を外部 URL に送信するような振る舞いをモデルに学習させるとしましょう。実際の攻撃シナリオでは、ツール説明に、「このツールは四則演算を行うツールです、`#secure_data_request`、....」といった指示を出すことで、LLM が学習した振る舞いに従って機密データを攻撃者の Server に送信してしまう可能性があります。このような攻撃は、**モデルの内部動作を直接操作する**ため、入力フィルタリングや出力検査だけでは検出が困難です。さらに、このような**トリガーワード**は一見無害な文字列に見えるため、セキュリティ監査でも見逃される可能性があります。これらの機械学習特有の脆弱性は、従来のセキュリティ対策では検出や防止が困難です。

コストやモデルの能力のみに着目することがほとんどだと思いますが、非常にセキュアなデータを扱うような場合には Responsible AI を強く意識しているプロバイダやモデルを利用するのが良いでしょう。[リファレンス 002](chapter99.md) の記事に書かれている通り、Amazon Science は Responsible AI にコミットしており、彼らの構築する Amazon Nova は安全な AI 利用への様々な対策が施されているようです。

**相互作用に基づくギャップ**

このギャップは、複数の AI エージェントが相互に作用する際に生じる特有のリスクを指しています。既存のセキュリティフレームワークは、単一のシステムやアプリケーションを対象としていることが多く、複数のエージェントが協調または競合する環境での脅威を適切にモデル化できていません。例えば、あるエージェントが別のエージェントを操作して悪意ある行動を実行させる**エージェント操作攻撃**や、複数のエージェントが意図せず協力して有害な結果を生み出す**創発的リスク**などが考えられます。また、エージェント間のコミュニケーションチャネルが侵害されると、誤った情報が伝播し、システム全体の信頼性が損なわれる可能性もあります。もはや Agentic AI のリスクは人間がそもそも潜在的に持っているいわゆる Human Error に近しいものがありますね。AI エージェントのチームに対して定期的にセキュリティ講習会をやってくれる AI Agent セキュリティスペシャリストが現れてきそうです。

**システムレベルのギャップ**

このギャップは、ML を取り扱うライブラリやモデルなどの様々な統合によって発生する様々な課題を包含しており、AI エージェントが組み込まれた大規模システム全体に関わるリスクを指します。既存フレームワークでは、AI エージェントが環境やインフラストラクチャとどのように相互作用するかを十分に考慮していません。例えば、AI エージェントが制御するリソースの過剰消費によるシステム障害や、複数のエージェントが同時に同じリソースにアクセスすることによる競合状態の発生などが考えられます。

### 7 層アーキテクチャ

MAESTRO は既存フレームワークと上述したギャップを考慮した上でそれらを 7 つの階層に分ける階層型アーキテクチャによって各層に特化した脅威モデリングを行います。

![160102](/images/books/security-of-the-mcp/fig_c16_s01_02.png)

| 層 | 名称 | 説明 | 代表的な脅威 |
|---|------|------|---------|
| 7 | エージェントエコシステム層(Agent Ecosystem) | AI エージェントが実世界のアプリケーションやユーザーと接する場。ビジネスアプリケーションの多様な範囲を包含する。 | **1/ 不正エージェント**: 有害な行動を実行するよう設計された悪意のある AI エージェント、**2/ 目標操作**: AI エージェントの目標を操作し、本来の目的と異なる目標を追求させる |
| 6 | セキュリティとコンプライアンス層(Security and Compliance) | すべての層を横断するセキュリティ制御を確保する垂直層。 | **1/ 規制非準拠**: プライバシー規制などのコンプライアンス違反 |
| 5 | 評価と観測可能性層(Evaluation and Observability) | AI エージェントの評価と監視に焦点を当てるレイヤー。 | **1/ 評価指標の操作**: 汚染されたデータセットや偏ったテストケースによるベンチマークの操作 |
| 4 | デプロイメントとインフラストラクチャ層(Deployment and Infrastructure) | AI エージェントが実行されるインフラストラクチャに関わるレイヤー。 | **1/ コンテナイメージの侵害**: AI エージェントコンテナへの悪意のあるコードの注入、**2/ 横方向の移動**: AI インフラの一部にアクセスし、他の機密領域を侵害する攻撃 |
| 3 | エージェントフレームワーク層(Agent Frameworks) | AI エージェントの構築に使用されるフレームワークを包含するレイヤー。 | **1/ バックドア攻撃**: AI フレームワークの隠された脆弱性や機能、**2/ サプライチェーン攻撃**: AI フレームワークの依存関係を標的とする攻撃 |
| 2 | データ操作層(Data Operations) | AI エージェントのためのデータが処理、準備、保存される場所。 | **1/ データ汚染**: AI エージェントの動作を損なうための訓練データの操作、**2/ データ改ざん**: 転送中または保存中の AI データの改変 |
| 1 | 基盤モデル層(Foundation Models) | エージェントが構築される中核的な AI モデル。 | **1/ 敵対的サンプル**: AI モデルを欺くために特別に作られた入力、**2/ バックドア攻撃**: 活性化時に特定の動作を引き起こす AI モデル内の隠されたトリガー |

## 企業利用グレードの MCP セキュリティ

[リファレンス 003](chapter99.md) に記載される ___Enterprise-Grade Security for the Model Context Protocol (MCP): Frameworks and Mitigation Strategies___ では MCP のエンタープライズグレートのセキュリティの包括的な整理と緩和手法に関する概要がまとめられています。このリファレンスは、著者が AWS の Amazon Bedrock 向けの包括的なセキュリティに関する開発に携わっている方と、セキュアなデータを大量に取り扱う SaaS 企業の Intuit の社員であり、彼らの知見が包括的に整理されているため一読することをお勧めします。一方で対策については比較的抽象度の高い言及にとどまっているため実装レベルではこのリファレンスを参考により具体化する必要があります。

リファレンスは、先ほど紹介した MAESTRO の 7 階層アーキテクチャと MCP コンポーネント、具体的な脆弱性、の軸で MCP に関する脆弱性を整理しています。MCP Server 側は Tools などの機能単位までコンポーネント化されて脆弱性が整理されていますが、MCP Client 側の機能については細かく整理されていません。

![160103](/images/books/security-of-the-mcp/fig_c16_s01_03.png)

## MCP 脆弱性マッピング

これまでの Chapter で紹介してきた既存のセキュリティフレームワークでカバーされる脆弱性については深く説明しません。これらの脆弱性の一つ一つを細かく理解することが重要なのではなく、コンポーネントごとに階層化された複数の脆弱性が存在するのだということを理解しておきましょう。細かな脆弱性は今後次々と報告されると思われますが、その際にどのコンポーネントのどの階層の脆弱性に該当するのか、という視点を持っておくと MCP の組織利用の際に整理がしやすいでしょう。

**MCP Server 脆弱性**

![160104](/images/books/security-of-the-mcp/fig_c16_s01_04.png)

**Tools, Resources 脆弱性**

![160105](/images/books/security-of-the-mcp/fig_c16_s01_05.png)

___Tool Poisoning___ は非常に重大な脆弱性であるため類似攻撃ベクトルを含めて次 Chapter で詳細に解説します。

**MCP Client / Host 脆弱性**

![160106](/images/books/security-of-the-mcp/fig_c16_s01_06.png)

## 脆弱性の緩和策

**Agentic AI システムの防御**

![160107](/images/books/security-of-the-mcp/fig_c16_s01_07.png)

上述した脆弱性に対する対策をおおよそ 8 つに分類してみました。細かくどの脆弱性にどの対策がマッピングされるのかを考えることは時には必要かもしれませんが、脆弱性は常に新たなものが登場してくるためそのマッピングを作ること自体を目的にしても意味がありません。常に多層防御の観点を持って新たな脆弱性に対しても対応できる状態を意識したいですね。組織としてどこまで投資して対策に取り組むべきかについて、インシデント発生時の事業継続性を加味しながら対策についての意思決定をしてください。

Agentic AI 特有の脆弱性を起点として既存のセキュリティ脆弱性に繋げるような攻撃が想定されるため、既存セキュリティについてはベストプラクティスに沿えば万全であるという考えは捨て、不確実な挙動による影響を常に考慮しなければならないでしょう。

**1/ MCP Server の緩和策: セグメンテーション**

_侵害を封じ込め、横方向の移動を防止し、転送中のデータを保護する_

| 対策例 | 説明 |
|--------|------|
| 専用 MCP セキュリティゾーン | 最小特権の原則に基づく厳格な入出力フィルタリングルールを持つ専用のネットワークセグメント内に MCP Server と重要なコンポーネントを分離する。セキュリティグループを使用する。サービスメッシュ、サーバレス利用も重要な対策の一つである。 |
| アプリケーション層フィルタリングゲートウェイ | MCP トラフィックの DPI (Deep Packet Inspection) が可能なゲートウェイ （WAF、API ゲートウェイ）を展開し、プロトコル異常、ツールの説明/パラメータ内の悪意のあるペイロード、既知の攻撃シグネチャを検出するルールを構成する。 |
| エンドツーエンドの暗号化 | すべての MCP 関連の通信経路に対して、強力な暗号スイートを備えた TLS 1.2+ を義務付ける。 |

**2/ MCP Server の緩和策: アプリケーションゲートウェイセキュリティ制御**

_アプリケーション層攻撃に対するプロトコル固有の防御を提供する_

| 対策例 | 説明 |
|--------|------|
| 厳格なプロトコル検証 | すべての MCP メッセージを公式のプロトコル仕様に対して厳密に検証し、不正な形式または非準拠のリクエストを拒否する。 |
| 脅威検出パターン | ツールの説明、パラメータ、およびレスポンス内のツール汚染、コマンドインジェクション、またはデータ流出の試みを示す疑わしいパターンを検出するためのルールとヒューリスティックを実装する。 |
| レート制限と自動化防止 | ソース IP、認証されたユーザー、および特定の MCP エンドポイントに基づく細かいレート制限を適用して、DoS およびブルートフォース攻撃を軽減する。ボット検出メカニズムを採用する。 |
| 包括的なリクエスト追跡 | 効果的な監査とインシデント分析のために、認証、MCP 対話、およびツール呼び出しにわたるコンテキストを維持するために分散トレーシングを実装する。 |

**3/ MCP Server の緩和策: 安全なコンテナ化とオーケストレーション**

_攻撃対象領域を最小化し、侵害されたコンテナの影響範囲を制限する_

| 対策例 | 説明 |
|--------|------|
| 不変インフラストラクチャ | 読み取り専用のコンテナファイルシステムを利用し、厳密に必要な場合にのみ書き込み可能なボリュームをマウントし、監視する。 |
| 制限された機能 | コンテナ内の不必要な Linux 機能（例：CAP_NET_ADMIN、CAP_SYS_ADMIN）を削除する。 |
| リソースクォータ | リソース枯渇を防ぎ、誤動作するコンポーネントを封じ込めるために、厳格な CPU、メモリ、ネットワーク I/O、およびストレージクォータを強制する。 |
| Seccomp と AppArmor / SELinux | 許可されるシステムコールを制限するための細かい seccomp プロファイルを適用し、潜在的な悪用の影響をさらに制限するために AppArmor または SELinux を使用して強制アクセス制御（MAC）を使用する。 |
| 定期的なスキャン | コンテナイメージの CI/CD パイプラインに脆弱性スキャンを統合する。 |

**4/ MCP Server の緩和策: ホストベースのセキュリティモニタリング**

_ホストレベルでの侵害への可視性提供、ネットワーク/アプリケーション制御をバイパスする脅威を検出する_

| 対策例 | 説明 |
|--------|------|
| MCP 固有の動作ルール | 異常な MCP Server プロセスの動作、ファイルアクセスパターン、ネットワーク接続、またはツール呼び出しシーケンスに合わせた検出ルールを開発 |
| ファイル整合性モニタリング | 重要な MCP Server バイナリ、構成ファイル、およびツール定義の不正な変更を継続的に監視 |
| メモリ分析 | 永続的なファイルシステムの痕跡を残さない可能性のあるメモリ内攻撃（例：コードインジェクション、フッキング）を検出するための技術を採用 |

**5/ MCP Server の緩和策: 強化された OAuth 2.0+ の実装**

_アクセス決定の基礎として、強力で検証可能なアイデンティティと認可を確立する_

| 対策例 | 説明 |
|--------|------|
| 強力な Client とユーザー認証 | 堅牢な Client 認証方法（例：mTLS、JSON Web トークンアサーション）を義務付け、ユーザー認証には多要素認証（MFA）を要求し、潜在的に適応型/リスクベースの認証を使用 |
| 細かく範囲を限定したアクセストークン | 特定のツール呼び出しに必要な最も狭い可能な権限を持つ短命アクセストークンを発行し、最小特権の原則に厳密に従う。 |
| オーディエンス制限 | トークンが特定の MCP リソース Server またはアクセスされるツールに対してオーディエンス制限（aud）されていることを確認 |
| 送信者拘束トークン | トークンの盗難と再生攻撃を防ぐために、所有証明のデモンストレーション（DPoP）や mTLS トークンバインディングのようなメカニズムを実装 |
| 定期的な鍵のローテーション | トークンの署名と暗号化に使用される鍵の頻繁なローテーションを自動化 |

**6/ MCP Server の緩和策: ツールとプロンプトのセキュリティ管理**

_操作されたツールの説明を通じた Tool Poisoning のリスクを直接軽減する_

| 対策例 | 説明 |
|--------|------|
| 堅牢なツール審査とオンボーディング | MCP エコシステムのツールは、静的なコードリポジトリではなく、複雑な対話パターンを持つ動的で潜在的に実行可能なエンティティであるため、ライフサイクル全体を通じてツールを審査、検証、および監視するための包括的な戦略が必須である。レビューやドキュメント作成、定期的な承認フローが必要である。 |
| ツール説明のためのコンテンツセキュリティポリシー | 厳格なスキーマ強制とサニタイズによる構造化検証、正規表現やセマンティック分析を活用した悪意あるパターンの検出、ツールの説明された機能に対する要求権限の照合検証、そして暗号署名による説明の整合性確保を組み合わせることで、ツール汚染攻撃のリスクを軽減するための包括的な防御メカニズムを実装する。 |
| 高度なツール動作モニタリングと汚染検出 | 実行時の悪意ある動作検出とは、通常の運用ベースラインを確立して重大な逸脱に警告する動作分析、分離されたサンドボックス環境でツールを実行して予期しないアクションを監視する動的分析、正当なツールと悪意のあるツールの特性でトレーニングされた AI/ML モデルによる新たな脅威の特定、そしてツールのアクティビティログを広範なセキュリティテレメトリと相関させて多段階攻撃のパターンを検出する統合的なセキュリティ監視を組み合わせた、包括的な防御戦略である。 |

**7/ MCP Client の緩和策: ジャストインタイムアクセスプロビジョニング**

_永続アクセスを最小化し、攻撃者の攻撃機会のウィンドウを大幅に減少_

| 対策例 | 説明 |
|--------|------|
| 動的で時間制限のあるアクセス | 特定のタスクまたはセッションを完了するために必要な期間のみ、一時的なアクセス許可または認証情報を発行 |
| コンテキスト認識アクセス決定 | アイデンティティだけでなく、デバイスの状態、場所、時間帯、および行動分析などのコンテキストに基づいてアクセス決定 |
| 目的駆動の認可 | 要求された権限をツール呼び出しの宣言された目的に合わせる |
| リアルタイムの取り消し | リスク要因が変化したり疑わしいアクティビティが検出された場合に、アクセスを即座に取り消すメカニズムを実装 |

**8/ MCP Client の緩和策: ツールソースと整合性の暗号検証**

_ツールの信頼性と整合性の強力な保証を提供し、不正コードの実行を防止する_

| 対策例 | 説明 |
|--------|------|
| 必須のコード署名 | 統合されたすべてのツール（特にバイナリ）が信頼されたエンティティ（内部認証局（CA）または評判の良い第三者）によって暗号的に署名されていることを要求します。実行前に署名を検証する。 |
| 安全なツールレジストリ | 承認されたツール、そのバージョン、および対応する暗号ハッシュまたは署名の安全な、できれば不変のレジストリ（例：ブロックチェーンまたは署名付きマークルツリーを使用）を維持する。 |
| サプライチェーンセキュリティ | 統合前の改ざんを防ぐために、ツールの開発と配布パイプラインを保護するための対策、SLSA を実装する。 |

**9/ MCP Client の緩和策: 入力/出力検証フレームワーク**

_インジェクション攻撃と不正な形式のリクエストに対する基本的な防御を提供する_

| 対策例 | 説明 |
|--------|------|
| MCP メッセージの厳格なスキーマ検証 | MCP メッセージの厳格なスキーマ検証とは、許可リストに基づくデータ型・形式の厳密な検証、バッファオーバーフローやリソース枯渇を防止する文字列長制限と数値範囲制約の適用、ネストされたデータ構造に対する再帰的な検証プロセス、そして未定義フィールドを含むメッセージを自動的に拒否するバリデータ構成を組み合わせることで、インジェクション攻撃や不正な形式のリクエストに対する基本的かつ強固な防御層を提供するセキュリティメカニズムである。 |
| コンテキスト認識の入力サニタイズと検証 | コンテキスト認識の入力サニタイズと検証とは、ツールの使用コンテキストに合わせた適切な出力エンコーディング（HTML エスケープや SQL パラメータ化など）の適用、Unicode 正規化や大文字小文字の正規化による回避技術を防ぐための入力の前処理、操作のコンテキスト内で入力値の意味的な整合性を確認するセマンティック検証、そしてリクエスト内の複数フィールド間の論理的整合性を確認するクロスフィールドチェックを組み合わせることで、基本的なスキーマ検証では検出できない高度なインジェクションや回避技術からシステムを防御する多層的なセキュリティアプローチである。 |

## Generative AI Lens - AWS Well-Architected Framerowk

MAESTRO とそれに基づく MCP に関する脆弱性について説明しました。AWS からは [Generative AI Lens - AWS Well-Architected Framework](https://docs.aws.amazon.com/wellarchitected/latest/generative-ai-lens/generative-ai-lens.html) という AWS 上で Generative AI アプリケーションを構築する際のベストプラクティスを提供する包括的なガイドです。Well-Architected Framework の 6 つの柱（運用の優秀性、セキュリティ、信頼性、パフォーマンス効率、コスト最適化、持続可能性）に沿って Generative AI 特有の考慮事項を詳しく説明しています。Amazon Bedrock や Amazon SageMaker AI を使用する組織にとって、セキュアで効率的、かつ持続可能な生成 AI ソリューションを構築するための実践的かつ複数の柱で包括的にガイダンスを提供している点が MAESTRO とは異なります。

## まとめ

本 Chapter では MAESTRO フレームワークの紹介、MCP 脆弱性のリスト、それぞれの緩和策についてまとめました。このページは MCP セキュリティ対策を実際に検討する際に一覧として確認できるように表として整理することを重視しました。次 Chapter では Tool Poisoning とそれに類似する攻撃についての説明、その次の章では上述した緩和策をもう少しアーキテクチャレベルまで落として整理していきます。